---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';
import notionLogo from '../assets/images/outils/notion.png';
import n8nLogo from '../assets/images/outils/n8n.png';
import supabaseLogo from '../assets/images/outils/supabase.webp';
import codaLogo from '../assets/images/outils/coda.webp';
import makeLogo from '../assets/images/outils/make.svg';
import wewebLogo from '../assets/images/outils/weweb.png';
import dorikLogo from '../assets/images/outils/dorik.png';
import airtableLogo from '../assets/images/outils/airtable.png';

const tools = [
  {
    name: "Notion",
    description: "Espace de travail centralisé et connecté.",
    category: "Documentation & Collaboration",
    tags: ["Collaboratif", "Base de données", "Gratuit"],
    features: [
      "Gestion de projets",
      "Base de données",
      "Collaboration",
      "Création de contenu",
      "Suivi des données",
      "Personnalisation"
    ],
    color: "purple",
    logo: notionLogo
  },
  {
    name: "n8n",
    description: "Plateforme d'automatisation open-source et auto-hébergée.",
    category: "Automatisation",
    tags: ["Opensource", "Auto-hébergé", "Workflows", "Automatisation"],
    features: [
      "Automatisation de workflows",
      "Intégrations multiples",
      "Open-source et auto-hébergé",
      "Workflows visuels",
      "Gestion des données",
      "API et webhooks"
    ],
    color: "pink",
    logo: n8nLogo
  },
  {
    name: "Supabase",
    description: "Backend open-source avec base de données PostgreSQL et authentification.",
    category: "Base de données & Backend",
    tags: ["PostgreSQL", "Opensource", "Temps réel", "Auto-hébergé", "Base de données"],
    features: [
      "Base de données PostgreSQL",
      "Authentification intégrée",
      "API REST automatique",
      "Stockage de fichiers",
      "Temps réel",
      "Open-source"
    ],
    color: "green",
    logo: supabaseLogo
  },
  {
    name: "Coda",
    description: "Le futur du document interactif et collaboratif.",
    category: "Documentation & Collaboration",
    tags: ["Interactif", "Automatisation", "Temps réel", "Collaboratif"],
    features: [
      "Gestion de projets et tâches",
      "Bases de données interactives",
      "Automatisation des processus",
      "Collaboration en temps réel",
      "Création de documents interactifs",
      "Suivi des KPI"
    ],
    color: "orange",
    logo: codaLogo
  },
  {
    name: "Make (Integromat)",
    description: "Plateforme d'automatisation aux possibilités quasi infinies.",
    category: "Automatisation",
    tags: ["Cloud", "Intégrations", "Sans code", "Automatisation"],
    features: [
      "Automatisez",
      "Centralisez",
      "Créez des flux de travail sans coder",
      "Synchronisez vos données",
      "Soyez notifiés",
      "Économisez des ressources"
    ],
    color: "purple",
    logo: makeLogo
  },
  {
    name: "Weweb",
    description: "Pour aller plus loin avec vos applications web",
    category: "Développement Web",
    tags: ["Applications", "Sans code", "Évolutif", "Auto-hébergé"],
    features: [
      "Développement Rapide",
      "Coûts Abordables",
      "Flexibilité Maximale",
      "Évolutivité Facilitée",
      "Fonctionnalités Avancées",
      "Démarrage Rapide",
      "Risques Minimisés"
    ],
    color: "red",
    logo: wewebLogo
  },
  {
    name: "Dorik",
    description: "Création de site web en un éclair",
    category: "Développement Web",
    tags: ["Sites vitrine", "Rapide", "SEO"],
    features: [
      "Simplicité de Création",
      "Adaptabilité Mobile",
      "Bibliothèque de Blocs Réutilisables",
      "Esthétique Professionnelle",
      "SEO Intégré",
      "Performances Optimisées"
    ],
    color: "blue",
    logo: dorikLogo
  },
  {
    name: "Airtable",
    description: "Pour donner vie à vos données",
    category: "Base de données & Backend",
    tags: ["Base de données", "Vues multiples", "Collaboratif"],
    features: [
      "Bases de données relationnelles",
      "Vues multiples",
      "Automatisation",
      "Collaboration",
      "Intégrations",
      "Formulaires personnalisés"
    ],
    color: "yellow",
    logo: airtableLogo
  }
];

const getIconBg = (color: string) => {
  const colors: Record<string, string> = {
    purple: "bg-purple-100",
    orange: "bg-orange-100",
    red: "bg-red-100",
    blue: "bg-blue-100",
    green: "bg-green-100",
    yellow: "bg-yellow-100",
    pink: "bg-pink-100"
  };
  return colors[color] || "bg-gray-100";
};

const getCardBg = (color: string) => {
  const colors: Record<string, string> = {
    purple: "bg-purple-50",
    orange: "bg-orange-50",
    red: "bg-red-50",
    blue: "bg-blue-50",
    green: "bg-green-50",
    yellow: "bg-yellow-50",
    pink: "bg-pink-50"
  };
  return colors[color] || "bg-gray-50";
};

const getBorderColor = (color: string) => {
  const colors: Record<string, string> = {
    purple: "border-b-purple-500",
    orange: "border-b-orange-500",
    red: "border-b-red-500",
    blue: "border-b-blue-500",
    green: "border-b-green-500",
    yellow: "border-b-yellow-500",
    pink: "border-b-pink-500"
  };
  return colors[color] || "border-b-gray-500";
};

const getColorClasses = (color: string) => {
  const colors: Record<string, { bg: string; text: string; border: string }> = {
    purple: { bg: "bg-purple-100", text: "text-purple-600", border: "border-purple-500" },
    orange: { bg: "bg-orange-100", text: "text-orange-600", border: "border-orange-500" },
    red: { bg: "bg-red-100", text: "text-red-600", border: "border-red-500" },
    blue: { bg: "bg-blue-100", text: "text-blue-600", border: "border-blue-500" },
    green: { bg: "bg-green-100", text: "text-green-600", border: "border-green-500" },
    yellow: { bg: "bg-yellow-100", text: "text-yellow-600", border: "border-yellow-500" },
    pink: { bg: "bg-pink-100", text: "text-pink-600", border: "border-pink-500" }
  };
  return colors[color] || colors.purple;
};

// Extraire uniquement les tags de filtrage spécifiés
const filterableTags = ["Applications", "Auto-hébergé", "Automatisation", "Base de données", "Collaboratif", "Opensource"];
const allTags = filterableTags.sort();
---

<Layout title="Nos outils No-Code - New Focus">
  <!-- Hero Section -->
  <section class="relative min-h-[400px] md:min-h-[500px] overflow-hidden flex items-center justify-center" style="background: radial-gradient(circle at 30% 40%, #6366f1 0%, #4F46E5 60%, #4F46E5 100%);">
    <div class="container mx-auto px-4 relative z-10 w-full">
      <div class="max-w-4xl mx-auto text-center text-white">
        <h1 class="text-5xl md:text-6xl font-extrabold mb-6 text-white">Nos outils</h1>
        <p class="text-xl md:text-2xl opacity-90 mb-4">
          Plus que de simples outils, chaque outil Nocode vient avec un paradigme et une culture spécifique.
        </p>
        <p class="text-lg md:text-xl opacity-80">
          Voici quels sont les outils principaux utilisés chez New Focus.
        </p>
      </div>
    </div>
  </section>

  <!-- Liste des outils -->
  <section class="py-20 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-6xl mx-auto">
        <!-- Grille des outils -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">
          {tools.map((tool) => {
            const cardBg = getCardBg(tool.color);
            const borderColor = getBorderColor(tool.color);
            const iconBg = getIconBg(tool.color);
            const toolId = tool.name.toLowerCase().replace(/\s+/g, '-').replace(/[()]/g, '').replace('integromat', '');
            return (
              <a 
                href={`#${toolId}`} 
                class={`${cardBg} border-2 border-gray-100 rounded-lg p-6 hover:shadow-lg transition-all ${borderColor} border-b-4 cursor-pointer block`}
              >
                <div class={`w-14 h-14 ${iconBg} rounded-xl flex items-center justify-center mb-5 p-2`}>
                  {tool.logo ? (
                    <Image src={tool.logo} alt={tool.name} class="w-full h-full object-contain" />
                  ) : (
                    <span class="text-2xl font-bold text-gray-600">{tool.name.charAt(0)}</span>
                  )}
                </div>
                <h3 class="text-xl font-bold mb-3 text-gray-900">{tool.name}</h3>
                <p class="text-gray-600 leading-relaxed">
                  {tool.description}
                </p>
              </a>
            );
          })}
        </div>

        <!-- Séparateur visuel -->
        <div class="my-20 flex items-center">
          <div class="flex-grow border-t border-gray-300"></div>
          <div class="px-6 text-gray-400 text-sm font-medium">Détails des outils</div>
          <div class="flex-grow border-t border-gray-300"></div>
        </div>

        <!-- Section de filtres -->
        <div class="mb-12">
          <div class="flex flex-wrap gap-3 justify-center">
            <button 
              class="filter-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors active"
              data-tag="all"
            >
              Tous
            </button>
            {allTags.map((tag) => (
              <button 
                class="filter-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors"
                data-tag={tag}
              >
                {tag}
              </button>
            ))}
          </div>
        </div>

        <!-- Détails des outils principaux -->
        <div id="tools-details" class="space-y-16">
          {tools.map((tool, index) => {
            const colors = getColorClasses(tool.color);
            const isEven = index % 2 === 0;
            const toolId = tool.name.toLowerCase().replace(/\s+/g, '-').replace(/[()]/g, '').replace('integromat', '');
            const toolTags = (tool.tags || []).join(',');
            return (
              <div 
                id={toolId} 
                class={`tool-detail-section grid md:grid-cols-2 gap-12 items-center scroll-mt-20 ${!isEven ? 'md:flex-row-reverse' : ''}`}
                data-tags={toolTags}
              >
                <div class={isEven ? '' : 'md:order-2'}>
                  <div class="mb-4">
                    <span class="text-sm font-semibold text-gray-500 uppercase tracking-wide">{tool.category}</span>
                  </div>
                  <h2 class={`text-4xl md:text-5xl font-bold mb-4 ${colors.text}`}>{tool.name}</h2>
                  {tool.tags && (
                    <div class="flex flex-wrap gap-2 mb-6">
                      {tool.tags.map((tag) => (
                        <span class={`px-3 py-1 rounded-full text-sm font-medium ${colors.bg} ${colors.text} border border-current/20`}>
                          {tag}
                        </span>
                      ))}
                    </div>
                  )}
                  <ul class="space-y-2 mb-8">
                    {tool.features.map((feature) => (
                      <li class="flex items-center gap-3">
                        <span class={`${colors.text}`}>•</span>
                        <span class="text-gray-700">{feature}</span>
                      </li>
                    ))}
                  </ul>
                  <a href="#" class={`inline-block ${colors.text} font-semibold hover:underline`}>
                    Voir un exemple →
                  </a>
                </div>
                <div class={`${isEven ? '' : 'md:order-1'} rounded-xl h-64 overflow-hidden bg-gray-100 flex items-center justify-center`}>
                  {tool.logo && (
                    <Image src={tool.logo} alt={tool.name} class="max-w-full max-h-full object-contain" />
                  )}
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-20 bg-[#faf8f3]">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto text-center">
        <p class="text-lg md:text-xl text-gray-600 italic font-light leading-relaxed">Des outils au service des humains, pas l'inverse.</p>
      </div>
    </div>
  </section>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const filterButtons = document.querySelectorAll('.filter-tag');
    const toolSections = document.querySelectorAll('.tool-detail-section');

    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        const selectedTag = button.getAttribute('data-tag');

        // Mettre à jour l'état actif des boutons
        filterButtons.forEach(btn => {
          btn.classList.remove('active', 'bg-[#4F46E5]', 'text-white');
          btn.classList.add('bg-gray-200', 'text-gray-700');
        });
        button.classList.add('active', 'bg-[#4F46E5]', 'text-white');
        button.classList.remove('bg-gray-200', 'text-gray-700');

        // Filtrer les sections
        toolSections.forEach(section => {
          if (selectedTag === 'all') {
            section.style.display = '';
          } else {
            const sectionTags = section.getAttribute('data-tags')?.split(',') || [];
            if (sectionTags.includes(selectedTag)) {
              section.style.display = '';
            } else {
              section.style.display = 'none';
            }
          }
        });
      });
    });
  });
</script>

<style>
  .filter-tag.active {
    background-color: #4F46E5;
    color: white;
  }
</style>

